# 深度图补偿系统 - 项目概述

## 目的

本系统是深度相机校准和补偿的完整解决方案，用于提高深度测量的线性度和精度。系统可以：
- 建立补偿模型（基于标定数据）
- 应用补偿模型（提高测量精度）
- 评估测量质量（线性度、重复精度）

## 技术栈

### 核心算法（Python）
- **NumPy**: 数值计算
- **SciPy**: 三次样条插值、滤波处理
- **Pillow**: 深度图读写（16位PNG）

### 图形界面
- **Tkinter**: 跨平台GUI框架

### 产品集成（C++）
- **纯C++11**: 无第三方依赖
- **JSON解析器**: 自实现，轻量级

## 项目约定

### 代码风格
- Python代码使用中文注释
- 函数和变量使用英文命名（snake_case）
- 类名使用PascalCase
- 配置参数使用UPPER_SNAKE_CASE

### 深度转换公式
```
深度值(mm) = (灰度值 - OFFSET) × SCALE_FACTOR / 1000
```
默认参数：
- OFFSET = 32768
- SCALE_FACTOR = 1.6
- 无效像素值 = 65535

### 文件格式
- 深度图：16位无符号整数 PNG
- 位移数据：CSV文件，包含"实际累计位移(mm)"列
- 补偿模型：JSON格式

## 领域知识

### 线性度（BFSL方法）
Best Fit Straight Line方法计算线性度：
1. 零点归一化（相对值）
2. 最小二乘线性拟合
3. 计算与拟合线的最大偏差
4. 线性度 = 最大偏差 / 满量程 × 100%

### 补偿模型
使用三次样条插值建立测量值到实际值的映射：
- 正向模型：实际值 → 测量值
- 逆向模型：测量值 → 实际值（用于补偿）

### 滤波处理
1. 3σ异常值去除
2. 中值滤波（去除椒盐噪声）
3. 高斯滤波（平滑）
4. 平面拟合校准（去除倾斜）

## 重要约束

### 数据要求
- 标定数据至少4个点（三次样条要求）
- 标定数据需覆盖测量量程
- 深度图必须是16位PNG格式

### 性能指标
- 典型补偿后线性度：< 0.05%
- 典型改善幅度：> 70%
- C++单次补偿耗时：< 1μs

## 外部依赖

### Python环境
```
numpy>=1.20
scipy>=1.7
pillow>=9.0
```

### C++编译
- C++11或更高版本
- CMake 3.10+（可选）
